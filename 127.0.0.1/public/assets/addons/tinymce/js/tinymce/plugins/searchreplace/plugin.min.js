/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.3.0 (TBD)
 */
!function(){"use strict";var e,t,n,f=function(e){var t=e;return{get:function(){return t},set:function(e){t=e}}},r=tinymce.util.Tools.resolve("tinymce.PluginManager"),g=function(){return(g=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=function(e){return function(){return e}},i=a(!1),c=a(!0),o=a("[!-#%-*,-\\/:;?@\\[-\\]_{}\xa1\xab\xb7\xbb\xbf;\xb7\u055a-\u055f\u0589\u058a\u05be\u05c0\u05c3\u05c6\u05f3\u05f4\u0609\u060a\u060c\u060d\u061b\u061e\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0830-\u083e\u085e\u0964\u0965\u0970\u0df4\u0e4f\u0e5a\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u0fd9\u0fda\u104a-\u104f\u10fb\u1361-\u1368\u1400\u166d\u166e\u169b\u169c\u16eb-\u16ed\u1735\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944\u1945\u1a1e\u1a1f\u1aa0-\u1aa6\u1aa8-\u1aad\u1b5a-\u1b60\u1bfc-\u1bff\u1c3b-\u1c3f\u1c7e\u1c7f\u1cd3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u207d\u207e\u208d\u208e\u3008\u3009\u2768-\u2775\u27c5\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc\u29fd\u2cf9-\u2cfc\u2cfe\u2cff\u2d70\u2e00-\u2e2e\u2e30\u2e31\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\ua4fe\ua4ff\ua60d-\ua60f\ua673\ua67e\ua6f2-\ua6f7\ua874-\ua877\ua8ce\ua8cf\ua8f8-\ua8fa\ua92e\ua92f\ua95f\ua9c1-\ua9cd\ua9de\ua9df\uaa5c-\uaa5f\uaade\uaadf\uabeb\ufd3e\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a\uff1b\uff1f\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]"),d=function(){return u},u=(e=function(e){return e.isNone()},{fold:function(e,t){return e()},is:i,isSome:i,isNone:c,getOr:n=function(e){return e},getOrThunk:t=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:a(null),getOrUndefined:a(undefined),or:n,orThunk:t,map:d,each:function(){},bind:d,exists:i,forall:c,filter:d,equals:e,equals_:e,toArray:function(){return[]},toString:a("none()")}),s=function(n){var e=a(n),t=function(){return o},r=function(e){return e(n)},o={fold:function(e,t){return t(n)},is:function(e){return n===e},isSome:c,isNone:i,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:t,orThunk:t,map:function(e){return s(e(n))},each:function(e){e(n)},bind:r,exists:r,forall:r,filter:function(e){return e(n)?o:u},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(e){return e.is(n)},equals_:function(e,t){return e.fold(i,function(e){return t(n,e)})}};return o},m={some:s,none:d,from:function(e){return null===e||e===undefined?u:s(e)}},h=o,p=tinymce.util.Tools.resolve("tinymce.util.Tools");function x(e){return e&&1===e.nodeType&&"false"===e.contentEditable}function v(e,t,n,r,o){var a,i,p,f,m,g,c=[],d=0;function u(e,t){if(t=t||0,!e[0])throw new Error("findAndReplaceDOMText cannot handle zero-length matches");var n=e.index;if(0<t){var r=e[t];if(!r)throw new Error("Invalid capture group");n+=e[0].indexOf(r),e[0]=r}return[n,n+e[0].length,[e[0]]]}if(p=t.ownerDocument,f=o.getBlockElements(),m=o.getWhiteSpaceElements(),g=o.getShortEndedElements(),i=function s(e){var t;if(3===e.nodeType)return e.data;if(m[e.nodeName]&&!f[e.nodeName])return"";if(t="",x(e))return"\n";if((f[e.nodeName]||g[e.nodeName])&&(t+="\n"),e=e.firstChild)for(;t+=s(e),e=e.nextSibling;);return t}(t)){if(e.global)for(;a=e.exec(i);)c.push(u(a,r));else a=i.match(e),c.push(u(a,r));return c.length&&(d=c.length,function h(e,t,n){var r,o,a,i,c=[],d=0,u=e,s=t.shift(),l=0;e:for(;;){if((f[u.nodeName]||g[u.nodeName]||x(u))&&d++,3===u.nodeType&&(!o&&u.length+d>=s[1]?(o=u,i=s[1]-d):r&&c.push(u),!r&&u.length+d>s[0]&&(r=u,a=s[0]-d),d+=u.length),r&&o){if(u=n({startNode:r,startNodeIndex:a,endNode:o,endNodeIndex:i,innerNodes:c,match:s[2],matchIndex:l}),d-=o.length-i,o=r=null,c=[],l++,!(s=t.shift()))break}else if(m[u.nodeName]&&!f[u.nodeName]||!u.firstChild){if(u.nextSibling){u=u.nextSibling;continue}}else if(!x(u)){u=u.firstChild;continue}for(;;){if(u.nextSibling){u=u.nextSibling;break}if(u.parentNode===e)break e;u=u.parentNode}}}(t,c,function l(e){var h;if("function"!=typeof e){var r=e.nodeType?e:p.createElement(e);h=function(e,t){var n=r.cloneNode(!1);return n.setAttribute("data-mce-index",t),e&&n.appendChild(p.createTextNode(e)),n}}else h=e;return function(e){var t,n,r,o=e.startNode,a=e.endNode,i=e.matchIndex;if(o===a){var c=o;r=c.parentNode,0<e.startNodeIndex&&(t=p.createTextNode(c.data.substring(0,e.startNodeIndex)),r.insertBefore(t,c));var d=h(e.match[0],i);return r.insertBefore(d,c),e.endNodeIndex<c.length&&(n=p.createTextNode(c.data.substring(e.endNodeIndex)),r.insertBefore(n,c)),c.parentNode.removeChild(c),d}t=p.createTextNode(o.data.substring(0,e.startNodeIndex)),n=p.createTextNode(a.data.substring(e.endNodeIndex));for(var u=h(o.data.substring(e.startNodeIndex),i),s=0,l=e.innerNodes.length;s<l;++s){var f=e.innerNodes[s],m=h(f.data,i);f.parentNode.replaceChild(m,f)}var g=h(a.data.substring(0,e.endNodeIndex),i);return(r=o.parentNode).insertBefore(t,o),r.insertBefore(u,o),r.removeChild(o),(r=a.parentNode).insertBefore(g,a),r.insertBefore(n,a),r.removeChild(a),g}}(n))),d}}var b=function(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t},N=function(e){var t=e.parentNode;e.firstChild&&t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)},l=function(e,t){var n,r=[];if((n=p.toArray(e.getBody().getElementsByTagName("span"))).length)for(var o=0;o<n.length;o++){var a=b(n[o]);null!==a&&a.length&&a===t.toString()&&r.push(n[o])}return r},y=function(e,t,n){var r=t.get(),o=r.index,a=e.dom;(n=!1!==n)?o+1===r.count?o=0:o++:o-1==-1?o=r.count-1:o--,a.removeClass(l(e,r.index),"mce-match-marker-selected");var i=l(e,o);return i.length?(a.addClass(l(e,o),"mce-match-marker-selected"),e.selection.scrollIntoView(i[0]),o):-1},w=function(e,t){var n=t.parentNode;e.remove(t),e.isEmpty(n)&&e.remove(n)},C=function(e,t,n,r,o){var a,i,c,d,u,s,l,f=(a=o,i="("+n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/\s/g,"[^\\S\\r\\n]")+")",a?"(?:^|\\s|"+h()+")"+i+"(?=$|\\s|"+h()+")":i),m=(c=e,d=t,u=new RegExp(f,r?"g":"gi"),(l=c.dom.create("span",{"data-mce-bogus":1})).className="mce-match-marker",s=c.getBody(),I(c,d,!1),v(u,s,l,1,c.schema));if(m){var g=y(e,t,!0);t.set({index:g,count:m,text:n,matchCase:r,wholeWord:o})}return m},T=function(e,t){var n=y(e,t,!0);t.set(g(g({},t.get()),{index:n}))},S=function(e,t){var n=y(e,t,!1);t.set(g(g({},t.get()),{index:n}))},k=function(e){var t=b(e);return null!==t&&0<t.length},B=function(e,t,n,r,o){var a,i,c,d,u,s=t.get(),l=s.index,f=l;for(r=!1!==r,c=e.getBody(),i=p.grep(p.toArray(c.getElementsByTagName("span")),k),a=0;a<i.length;a++){var m=b(i[a]);if(d=u=parseInt(m,10),o||d===s.index){for(n.length?(i[a].firstChild.nodeValue=n,N(i[a])):w(e.dom,i[a]);i[++a];){if((d=parseInt(b(i[a]),10))!==u){a--;break}w(e.dom,i[a])}r&&f--}else l<u&&i[a].setAttribute("data-mce-index",String(u-1))}return t.set(g(g({},s),{count:o?0:s.count-1,index:f})),(r?T:S)(e,t),!o&&0<t.get().count},I=function(e,t,n){var r,o,a,i,c=t.get();for(o=p.toArray(e.getBody().getElementsByTagName("span")),r=0;r<o.length;r++){var d=b(o[r]);null!==d&&d.length&&(d===c.index.toString()&&(a=a||o[r].firstChild,i=o[r].firstChild),N(o[r]))}if(t.set(g(g({},c),{index:-1,count:0,text:""})),a&&i){var u=e.dom.createRng();return u.setStart(a,0),u.setEnd(i,i.data.length),!1!==n&&e.selection.setRng(u),u}},E=tinymce.util.Tools.resolve("tinymce.Env"),O=function(a,i){var t,e=(t=f(m.none()),{clear:function(){t.set(m.none())},set:function(e){t.set(m.some(e))},isSet:function(){return t.get().isSome()},on:function(e){t.get().each(e)}});a.undoManager.add();var n=p.trim(a.selection.getContent({format:"text"}));function c(e){(1<i.get().count?e.enable:e.disable)("next"),(1<i.get().count?e.enable:e.disable)("prev")}var d=function(e,t){!function(e,t){for(var n=0,r=e.length;n<r;n++){t(e[n],n)}}(["replace","replaceall","prev","next"],t?e.disable:e.enable)};var u=function(e,t){E.browser.isSafari()&&E.deviceType.isTouch()&&("find"===t||"replace"===t||"replaceall"===t)&&e.focus(t)},s=function(e){I(a,i,!1),d(e,!0),c(e)},l=function(e){var t=e.getData(),n=i.get();if(t.findtext.length){if(n.text===t.findtext&&n.matchCase===t.matchcase&&n.wholeWord===t.wholewords)T(a,i);else{var r=C(a,i,t.findtext,t.matchcase,t.wholewords);r<=0&&!function o(e){a.windowManager.alert("Could not find the specified string.",function(){e.focus("findtext")})}(e),d(e,0===r)}c(e)}else s(e)},r=i.get(),o={title:"Find and Replace",size:"normal",body:{type:"panel",items:[{type:"bar",items:[{type:"input",name:"findtext",placeholder:"Find",maximized:!0,inputMode:"search"},{type:"button",name:"prev",text:"Previous",icon:"action-prev",disabled:!0,borderless:!0},{type:"button",name:"next",text:"Next",icon:"action-next",disabled:!0,borderless:!0}]},{type:"input",name:"replacetext",placeholder:"Replace with",inputMode:"search"}]},buttons:[{type:"menu",name:"options",icon:"preferences",tooltip:"Preferences",align:"start",items:[{type:"togglemenuitem",name:"matchcase",text:"Match case"},{type:"togglemenuitem",name:"wholewords",text:"Find whole words only"}]},{type:"custom",name:"find",text:"Find",primary:!0},{type:"custom",name:"replace",text:"Replace",disabled:!0},{type:"custom",name:"replaceall",text:"Replace All",disabled:!0}],initialData:{findtext:n,replacetext:"",wholewords:r.wholeWord,matchcase:r.matchCase},onChange:function(e,t){"findtext"===t.name&&0<i.get().count&&s(e)},onAction:function(e,t){var n,r,o=e.getData();switch(t.name){case"find":l(e);break;case"replace":(B(a,i,o.replacetext)?c:s)(e);break;case"replaceall":B(a,i,o.replacetext,!0,!0),s(e);break;case"prev":S(a,i),c(e);break;case"next":T(a,i),c(e);break;case"matchcase":case"wholewords":n=e.getData(),r=i.get(),i.set(g(g({},r),{matchCase:n.matchcase,wholeWord:n.wholewords})),s(e)}u(e,t.name)},onSubmit:function(e){l(e),u(e,"find")},onClose:function(){a.focus(),I(a,i),a.undoManager.add()}};e.set(a.windowManager.open(o,{inline:"toolbar"}))},A=function(e,t){return function(){O(e,t)}};!function M(){r.add("searchreplace",function(e){var t,n,r,o,a,i,c=f({index:-1,count:0,text:"",matchCase:!1,wholeWord:!1});return n=c,(t=e).addCommand("SearchReplace",function(){O(t,n)}),o=c,(r=e).ui.registry.addMenuItem("searchreplace",{text:"Find and replace...",shortcut:"Meta+F",onAction:A(r,o),icon:"search"}),r.ui.registry.addButton("searchreplace",{tooltip:"Find and replace",onAction:A(r,o),icon:"search"}),r.shortcuts.add("Meta+F","",A(r,o)),a=e,i=c,{done:function(e){return I(a,i,e)},find:function(e,t,n){return C(a,i,e,t,n)},next:function(){return T(a,i)},prev:function(){return S(a,i)},replace:function(e,t,n){return B(a,i,e,t,n)}}})}()}();