/**
 * Copyright (c) Tiny Technologies, Inc. All rights reserved.
 * Licensed under the LGPL or a commercial license.
 * For LGPL see License.txt in the project root for license information.
 * For commercial licenses see https://www.tiny.cloud/
 *
 * Version: 5.3.0 (TBD)
 */
!function(h){"use strict";var e,n,r,t,c=function(e){var n=e;return{get:function(){return n},set:function(e){n=e}}},o=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=function(e){return{isFullscreen:function(){return null!==e.get()}}},i=function(){},w=function(e){return function(){return e}},s=w(!1),a=w(!0),f=function(){return l},l=(e=function(e){return e.isNone()},{fold:function(e,n){return e()},is:s,isSome:s,isNone:a,getOr:r=function(e){return e},getOrThunk:n=function(e){return e()},getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:w(null),getOrUndefined:w(undefined),or:r,orThunk:n,map:f,each:i,bind:f,exists:s,forall:a,filter:f,equals:e,equals_:e,toArray:function(){return[]},toString:w("none()")}),d=function(r){var e=w(r),n=function(){return o},t=function(e){return e(r)},o={fold:function(e,n){return n(r)},is:function(e){return r===e},isSome:a,isNone:s,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return d(e(r))},each:function(e){e(r)},bind:t,exists:t,forall:t,filter:function(e){return e(r)?o:l},toArray:function(){return[r]},toString:function(){return"some("+r+")"},equals:function(e){return e.is(r)},equals_:function(e,n){return e.fold(s,function(e){return n(r,e)})}};return o},m={some:d,none:f,from:function(e){return null===e||e===undefined?l:d(e)}},v=function(){return e=function(e){e.unbind()},n=c(m.none()),r=function(){n.get().each(e)},{clear:function(){r(),n.set(m.none())},isSet:function(){return n.get().isSome()},set:function(e){r(),n.set(m.some(e))}};var e,n,r},g=function(t){return function(e){return r=typeof(n=e),(null===n?"null":"object"==r&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"==r&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":r)===t;var n,r}},p=function(n){return function(e){return typeof e===n}},S=g("string"),y=g("array"),O=p("boolean"),E=p("function"),x=p("number"),T=Array.prototype.push,N=function(e,n){for(var r=e.length,t=new Array(r),o=0;o<r;o++){var i=e[o];t[o]=n(i,o)}return t},b=function(e,n){for(var r=0,t=e.length;r<t;r++){n(e[r],r)}},C=function(e,n){for(var r=[],t=0,o=e.length;t<o;t++){var i=e[t];n(i,t)&&r.push(i)}return r},D=function(e,n){return function(e){for(var n=[],r=0,t=e.length;r<t;++r){if(!y(e[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+e);T.apply(n,e[r])}return n}(N(e,n))},A=Object.keys,k=function(e,n){return-1!==e.indexOf(n)},M=function(e){return e.style!==undefined&&E(e.style.getPropertyValue)},F=function(e){if(null===e||e===undefined)throw new Error("Node cannot be null or undefined");return{dom:w(e)}},_={fromHtml:function(e,n){var r=(n||h.document).createElement("div");if(r.innerHTML=e,!r.hasChildNodes()||1<r.childNodes.length)throw h.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return F(r.childNodes[0])},fromTag:function(e,n){var r=(n||h.document).createElement(e);return F(r)},fromText:function(e,n){var r=(n||h.document).createTextNode(e);return F(r)},fromDom:F,fromPoint:function(e,n,r){var t=e.dom();return m.from(t.elementFromPoint(n,r)).map(F)}},R=("undefined"!=typeof h.window?h.window:Function("return this;")(),h.Node.ATTRIBUTE_NODE,h.Node.CDATA_SECTION_NODE,h.Node.COMMENT_NODE,h.Node.DOCUMENT_NODE),L=(h.Node.DOCUMENT_TYPE_NODE,h.Node.DOCUMENT_FRAGMENT_NODE,h.Node.ELEMENT_NODE),P=h.Node.TEXT_NODE,I=(h.Node.PROCESSING_INSTRUCTION_NODE,h.Node.ENTITY_REFERENCE_NODE,h.Node.ENTITY_NODE,h.Node.NOTATION_NODE,t=P,function(e){return e.dom().nodeType===t}),H=function(e,n,r){!function(e,n,r){if(!(S(r)||O(r)||x(r)))throw h.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,r+"")}(e.dom(),n,r)},W=function(e,n){var r=e.dom().getAttribute(n);return null===r?undefined:r},U=function(e,n){e.dom().removeAttribute(n)},B=function(e,n){var r=e.dom();!function(e,n){for(var r=A(e),t=0,o=r.length;t<o;t++){var i=r[t];n(e[i],i)}}(n,function(e,n){!function(e,n,r){if(!S(r))throw h.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);M(e)&&e.style.setProperty(n,r)}(r,n,e)})},V=function(e,n){var r,t,o=e.dom(),i=h.window.getComputedStyle(o).getPropertyValue(n);return""!==i||(t=I(r=e)?r.dom().parentNode:r.dom())!==undefined&&null!==t&&t.ownerDocument.body.contains(t)?i:q(o,n)},q=function(e,n){return M(e)?e.style.getPropertyValue(n):""},X=function(e){var r,t,n,o,i,u=_.fromDom(e.target),c=function(){return e.stopPropagation()},s=function(){return e.preventDefault()},a=(r=s,t=c,function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return r(t.apply(null,e))});return n=u,o=e.clientX,i=e.clientY,{target:w(n),x:w(o),y:w(i),stop:c,prevent:s,kill:a,raw:w(e)}},j=function(e,n){var r=function(e,n){for(var r=0;r<e.length;r++){var t=e[r];if(t.test(n))return t}return undefined}(e,n);if(!r)return{major:0,minor:0};var t=function(e){return Number(n.replace(r,"$"+e))};return z(t(1),t(2))},Y=function(){return z(0,0)},z=function(e,n){return{major:e,minor:n}},G={nu:z,detect:function(e,n){var r=String(n).toLowerCase();return 0===e.length?Y():j(e,r)},unknown:Y},$="Firefox",K=function(e){var n=e.current,r=e.version,t=function(e){return function(){return n===e}};return{current:n,version:r,isEdge:t("Edge"),isChrome:t("Chrome"),isIE:t("IE"),isOpera:t("Opera"),isFirefox:t($),isSafari:t("Safari")}},J={unknown:function(){return K({current:undefined,version:G.unknown()})},nu:K,edge:w("Edge"),chrome:w("Chrome"),ie:w("IE"),opera:w("Opera"),firefox:w($),safari:w("Safari")},Q="Windows",Z="Android",ee="Solaris",ne="FreeBSD",re="ChromeOS",te=function(e){var n=e.current,r=e.version,t=function(e){return function(){return n===e}};return{current:n,version:r,isWindows:t(Q),isiOS:t("iOS"),isAndroid:t(Z),isOSX:t("OSX"),isLinux:t("Linux"),isSolaris:t(ee),isFreeBSD:t(ne),isChromeOS:t(re)}},oe={unknown:function(){return te({current:undefined,version:G.unknown()})},nu:te,windows:w(Q),ios:w("iOS"),android:w(Z),linux:w("Linux"),osx:w("OSX"),solaris:w(ee),freebsd:w(ne),chromeos:w(re)},ie=function(e,n){var r=String(n).toLowerCase();return function(e,n){for(var r=0,t=e.length;r<t;r++){var o=e[r];if(n(o,r))return m.some(o)}return m.none()}(e,function(e){return e.search(r)})},ue=function(e,r){return ie(e,r).map(function(e){var n=G.detect(e.versionRegexes,r);return{current:e.name,version:n}})},ce=function(e,r){return ie(e,r).map(function(e){var n=G.detect(e.versionRegexes,r);return{current:e.name,version:n}})},se=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,ae=function(n){return function(e){return k(e,n)}},fe=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return k(e,"edge/")&&k(e,"chrome")&&k(e,"safari")&&k(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,se],search:function(e){return k(e,"chrome")&&!k(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return k(e,"msie")||k(e,"trident")}},{name:"Opera",versionRegexes:[se,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:ae("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:ae("firefox")},{name:"Safari",versionRegexes:[se,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(k(e,"safari")||k(e,"mobile/"))&&k(e,"applewebkit")}}],le=[{name:"Windows",search:ae("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return k(e,"iphone")||k(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:ae("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:ae("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:ae("linux"),versionRegexes:[]},{name:"Solaris",search:ae("sunos"),versionRegexes:[]},{name:"FreeBSD",search:ae("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:ae("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],de={browsers:w(fe),oses:w(le)},me=c(function(e,n){var r,t,o,i,u,c,s,a,f,l,d,m,h=de.browsers(),v=de.oses(),g=ue(h,e).fold(J.unknown,J.nu),p=ce(v,e).fold(oe.unknown,oe.nu);return{browser:g,os:p,deviceType:(t=g,o=e,i=n,u=(r=p).isiOS()&&!0===/ipad/i.test(o),c=r.isiOS()&&!u,s=r.isiOS()||r.isAndroid(),a=s||i("(pointer:coarse)"),f=u||!c&&s&&i("(min-device-width:768px)"),l=c||s&&!f,d=t.isSafari()&&r.isiOS()&&!1===/safari/i.test(o),m=!l&&!f&&!d,{isiPad:w(u),isiPhone:w(c),isTablet:w(f),isPhone:w(l),isTouch:w(a),isAndroid:r.isAndroid,isiOS:r.isiOS,isWebView:w(d),isDesktop:w(m)})}}(h.navigator.userAgent,function(e){return h.window.matchMedia(e).matches})),he=function(){return me.get()},ve=L,ge=R,pe=function(e,n){var r=e.dom();if(r.nodeType!==ve)return!1;var t=r;if(t.matches!==undefined)return t.matches(n);if(t.msMatchesSelector!==undefined)return t.msMatchesSelector(n);if(t.webkitMatchesSelector!==undefined)return t.webkitMatchesSelector(n);if(t.mozMatchesSelector!==undefined)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},we=function(e,n){var r,t=n===undefined?h.document:n.dom();return(r=t).nodeType!==ve&&r.nodeType!==ge||0===r.childElementCount?[]:N(t.querySelectorAll(e),_.fromDom)},Se=(he().browser.isIE(),function(r){var e;return e=r,m.from(e.dom().parentNode).map(_.fromDom).map(ye).map(function(e){return C(e,function(e){return n=e,r.dom()!==n.dom();var n})}).getOr([])}),ye=function(e){return N(e.dom().childNodes,_.fromDom)},Oe=function(r,t){return{left:w(r),top:w(t),translate:function(e,n){return Oe(r+e,t+n)}}},Ee=Oe,xe=(he().browser.isSafari(),function(e){var n=e===undefined?h.window:e;return m.from(n.visualViewport)}),Te=function(e,n,r,t){return{x:e,y:n,width:r,height:t,right:e+r,bottom:n+t}},Ne=function(e){var n,r,t,o,i=e===undefined?h.window:e,u=i.document,c=(n=_.fromDom(u),r=n!==undefined?n.dom():h.document,t=r.body.scrollLeft||r.documentElement.scrollLeft,o=r.body.scrollTop||r.documentElement.scrollTop,Ee(t,o));return xe(i).fold(function(){var e=i.document.documentElement,n=e.clientWidth,r=e.clientHeight;return Te(c.left(),c.top(),n,r)},function(e){return Te(Math.max(e.pageLeft,c.left()),Math.max(e.pageTop,c.top()),e.width,e.height)})},be=function(r,e,n){return xe(n).map(function(e){var n=function(e){return X(e)};return e.addEventListener(r,n),{unbind:function(){return e.removeEventListener(r,n)}}}).getOrThunk(function(){return{unbind:i}})},Ce=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),De=tinymce.util.Tools.resolve("tinymce.Env"),Ae=tinymce.util.Tools.resolve("tinymce.util.Delay"),ke=function(e,n){e.fire("FullscreenStateChanged",{state:n})},Me=function(e,n,r){return C(function(e,n){for(var r=E(n)?n:s,t=e.dom(),o=[];null!==t.parentNode&&t.parentNode!==undefined;){var i=t.parentNode,u=_.fromDom(i);if(o.push(u),!0===r(u))break;t=i}return o}(e,r),n)},Fe=function(e,n){return r=function(e){return pe(e,n)},C(Se(e),r);var r},_e="data-ephox-mobile-fullscreen-style",Re="position:absolute!important;",Le="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Pe=De.os.isAndroid(),Ie=function(o,e,n){var r,t,i,u=function(t){return function(e){var n=W(e,"style"),r=n===undefined?"no-styles":n.trim();r!==t&&(H(e,_e,r),B(e,o.parseStyle(t)))}},c=(r="*",Me(e,function(e){return pe(e,r)},t)),s=D(c,function(e){return Fe(e,"*:not(.tox-silver-sink)")}),a=(i=V(n,"background-color"))!==undefined&&""!==i?"background-color:"+i+"!important":"background-color:rgb(255,255,255)!important;";b(s,u("display:none!important;")),b(c,u(Re+Le+a)),u((!0===Pe?"":Re)+Le+a)(e)},He=function(r){var e=we("["+_e+"]");b(e,function(e){var n=W(e,_e);"no-styles"!==n?B(e,r.parseStyle(n)):U(e,"style"),U(e,_e)})},We=Ce.DOM,Ue=xe().fold(function(){return{bind:i,unbind:i}},function(n){var r,t=(r=c(m.none()),{clear:function(){r.set(m.none())},set:function(e){r.set(m.some(e))},isSet:function(){return r.get().isSome()},on:function(e){r.get().each(e)}}),o=v(),i=v(),u=Ae.throttle(function(){h.document.body.scrollTop=0,h.document.documentElement.scrollTop=0,h.window.requestAnimationFrame(function(){t.on(function(e){return B(e,{top:n.offsetTop+"px",left:n.offsetLeft+"px",height:n.height+"px",width:n.width+"px"})})})},50);return{bind:function(e){t.set(e),u(),o.set(be("resize")),i.set(be("scroll"))},unbind:function(){t.on(function(){o.clear(),i.clear()}),t.clear()}}}),Be=function(e,n){var r,t,o,i=h.document.body,u=h.document.documentElement;t=e.getContainer();var c,s,a=_.fromDom(t),f=n.get(),l=_.fromDom(e.getBody()),d=De.deviceType.isTouch();if(r=t.style,o=e.getContentAreaContainer().firstChild.style,f)o.width=f.iframeWidth,o.height=f.iframeHeight,r.width=f.containerWidth,r.height=f.containerHeight,r.top=f.containerTop,r.left=f.containerLeft,d&&He(e.dom),We.removeClass(i,"tox-fullscreen"),We.removeClass(u,"tox-fullscreen"),We.removeClass(t,"tox-fullscreen"),c=f.scrollPos,h.window.scrollTo(c.x,c.y),n.set(null),ke(e,!1),Ue.unbind(),e.off("remove",Ue.unbind);else{var m={scrollPos:{x:(s=Ne(h.window)).x,y:s.y},containerWidth:r.width,containerHeight:r.height,containerTop:r.top,containerLeft:r.left,iframeWidth:o.width,iframeHeight:o.height};d&&Ie(e.dom,a,l),o.width=o.height="100%",r.width=r.height="",We.addClass(i,"tox-fullscreen"),We.addClass(u,"tox-fullscreen"),We.addClass(t,"tox-fullscreen"),Ue.bind(a),e.on("remove",Ue.unbind),n.set(m),ke(e,!0)}},Ve=function(r,t){return function(n){n.setActive(null!==t.get());var e=function(e){return n.setActive(e.state)};return r.on("FullscreenStateChanged",e),function(){return r.off("FullscreenStateChanged",e)}}};!function qe(){o.add("fullscreen",function(e){var n,r,t,o,i=c(null);return e.settings.inline||(r=i,(n=e).addCommand("mceFullScreen",function(){Be(n,r)}),o=i,(t=e).ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return t.execCommand("mceFullScreen")},onSetup:Ve(t,o)}),t.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return t.execCommand("mceFullScreen")},onSetup:Ve(t,o)}),e.addShortcut("Meta+Shift+F","","mceFullScreen")),u(i)})}()}(window);